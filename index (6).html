<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIABS - Sistem Anti-Bullying Sekolah</title>
    <style>
        /* --- ESTETIKA MODERN & PALET WARNA --- */
        :root {
            --primary: #4F46E5; /* Indigo */
            --primary-light: #6366f1;
            --primary-dark: #4338ca;
            --secondary: #64748b;
            --accent: #0ea5e9; 
            --danger: #ef4444;
            --success: #10b981;
            --bg: #fdfdff; /* Latar belakang yang sangat terang */
            --card-bg: #ffffff;
            --text-main: #181825; /* Hitam pekat */
            --text-muted: #6b7280;
            --radius: 16px; /* Sudut lebih membulat */
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05); /* Shadow lebih lembut */
            --shadow-hover: 0 15px 25px -5px rgba(0, 0, 0, 0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Inter, sans-serif; }
        body { background-color: var(--bg); color: var(--text-main); line-height: 1.6; padding-bottom: 80px; transition: background-color 0.3s; }
        
        /* Typography */
        h1, h2, h3 { color: var(--text-main); font-weight: 700; }
        h1 { font-size: 2.8rem; line-height: 1.2; margin-bottom: 0.5rem; }
        h2 { font-size: 2rem; margin-bottom: 1.5rem; }
        h3 { font-size: 1.4rem; margin-bottom: 0.75rem; }
        p { margin-bottom: 1rem; color: var(--text-muted); }
        .text-sm { font-size: 0.9rem; }
        .text-center { text-align: center; }
        
        /* Layout & Utilities */
        .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
        .hidden { display: none !important; }
        .grid { display: grid; gap: 20px; }
        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
        
        /* Components */
        .btn {
            display: inline-flex; align-items: center; justify-content: center;
            padding: 12px 28px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: 0.3s; border: none; text-decoration: none;
            font-size: 1rem; /* Ukuran yang baik untuk sentuhan (touch target) */
        }
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3); }
        .btn-primary:hover { background: var(--primary-dark); box-shadow: 0 6px 15px rgba(79, 70, 229, 0.4); transform: translateY(-1px); }
        .btn-outline { border: 2px solid var(--primary); color: var(--primary); background: transparent; }
        .btn-outline:hover { background: var(--primary); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-ghost { background: transparent; color: var(--text-muted); padding: 8px 12px; }
        .btn-sm { padding: 8px 18px; font-size: 0.9rem; }

        .card { 
            background: var(--card-bg); 
            border-radius: var(--radius); 
            padding: 28px; 
            box-shadow: var(--shadow); 
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover {
            box-shadow: var(--shadow-hover);
        }
        
        /* --- NAVIGATION & MOBILE MENU --- */
        nav { background: white; padding: 15px 0; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 4px rgba(0,0,0,0.08); }
        nav .container { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 800; color: var(--primary); display: flex; align-items: center; gap: 8px; }
        
        .nav-links { display: flex; gap: 30px; }
        .nav-links a { text-decoration: none; color: var(--text-muted); font-weight: 500; cursor: pointer; transition: 0.2s; padding: 5px 0; }
        .nav-links a:hover, .nav-links a.active { color: var(--primary); font-weight: 600; }

        #menu-toggle {
            display: none; /* Hidden on desktop */
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
        }

        /* Hero Section */
        .hero { 
            padding: 80px 0; 
            display: flex; 
            align-items: center; 
            gap: 50px; 
            background: linear-gradient(135deg, var(--bg) 60%, var(--primary), var(--primary-light) 100%);
            background-clip: padding-box;
            background-color: var(--card-bg); /* Fallback */
            border-radius: var(--radius);
            margin: 20px 0;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        .hero-content { flex: 1; padding: 0 40px; }
        .hero-img { flex: 1; text-align: center; max-width: 400px; padding: 20px; }
        .hero-img .art { 
            width: 100%; height: 200px; 
            background: linear-gradient(45deg, var(--accent), var(--primary-light)); 
            border-radius: var(--radius); 
            display: flex; align-items: center; justify-content: center;
            color: white; font-size: 40px; font-weight: 900;
        }
        
        /* Form Styling */
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; font-size: 0.95rem; color: var(--text-main); }
        input, select, textarea {
            width: 100%; padding: 14px; border: 1px solid #e5e7eb; border-radius: 10px; font-size: 1rem; transition: 0.2s;
            background: #f9fafb; /* Latar belakang input lebih terang */
        }
        input:focus, textarea:focus { outline: none; border-color: var(--primary-light); box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.15); }
        .checkbox-group { display: flex; flex-wrap: wrap; gap: 10px; }
        .checkbox-card {
            border: 2px solid #e5e7eb; padding: 12px 20px; border-radius: 30px; cursor: pointer; user-select: none; font-size: 0.9rem;
            transition: all 0.2s;
            min-height: 44px; /* Minimum touch target size */
            display: flex; align-items: center;
        }
        .checkbox-card.checked { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 2px 5px rgba(79, 70, 229, 0.2); }
        .checkbox-card input { display: none; }

        /* Forum Styles Refined */
        .thread-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border: 1px solid #f1f5f9;
        }
        .thread-meta {
            margin-bottom: 12px;
            padding-bottom: 5px;
            border-bottom: 1px dashed #f1f5f9;
        }
        .thread-meta .anon-label {
            font-weight: 700;
            color: var(--primary);
            font-size: 1rem;
        }

        /* Floating Actions (FAB) */
        .floating-actions { position: fixed; bottom: 40px; right: 20px; display: flex; flex-direction: column; gap: 15px; z-index: 100; }
        .fab { width: 55px; height: 55px; border-radius: 50%; font-size: 22px; }

        /* Tombol Kembali (Back Button) */
        .back-button {
            margin-top: 25px;
            margin-bottom: 15px; 
            padding: 10px 18px;
            background: #eef2ff; 
            color: var(--primary);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }
        .back-button:hover { background: #e0e7ff; }

        /* --- RESPONSIVE OPTIMIZATION (Mobile) --- */
        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            h2 { font-size: 1.6rem; }

            .container { padding: 0 15px; }
            
            /* Mobile Navigation */
            .nav-links {
                position: fixed;
                top: 60px; /* Di bawah navbar */
                left: 0;
                right: 0;
                flex-direction: column;
                background: white;
                box-shadow: 0 5px 10px rgba(0,0,0,0.1);
                padding: 15px 20px;
                gap: 10px;
                border-top: 1px solid #f1f5f9;
                display: none;
            }
            .nav-links.active {
                display: flex;
            }
            .nav-links a {
                padding: 10px;
                border-radius: 8px;
                border-left: 5px solid transparent;
            }
            .nav-links a.active {
                border-left: 5px solid var(--primary);
                background: #f8fafc;
            }

            #menu-toggle {
                display: block; /* Show hamburger on mobile */
                color: var(--primary);
            }

            /* Hero Section */
            .hero { flex-direction: column-reverse; text-align: center; padding: 40px 0; margin: 10px 0; }
            .hero-content { padding: 0 20px; }
            .hero-img { max-width: 100%; }
            .hero-content h1 { font-size: 2.2rem; }
            .hero-content p { font-size: 0.95rem; }
            .hero-content > div { justify-content: center; }

            /* Grids */
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .card { padding: 20px; }

            /* FAB Position Adjustment */
            .floating-actions { bottom: 20px; right: 15px; }

            /* Form Adjustments */
            input, select, textarea { padding: 12px; }
            .checkbox-group { justify-content: center; }
            .checkbox-card { min-width: 45%; justify-content: center; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="container">
            <div class="logo">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                SIABS
            </div>
            <div class="nav-links" id="nav-links">
                <a onclick="showPage('home')" class="active">Beranda</a>
                <a onclick="showPage('report')">Laporkan</a>
                <a onclick="showPage('education')">Edukasi</a>
                <a onclick="showPage('forum')">Diskusi Anonim</a>
                <a onclick="showPage('procedure')">Prosedur</a>
                <a onclick="showPage('contact')">Bantuan</a>
                <a onclick="showPage('admin')">Admin</a>
            </div>
            <button id="menu-toggle" onclick="toggleMobileMenu()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
            </button>
        </div>
    </nav>

    <main class="container">
        
        <button id="back-btn" class="back-button hidden" onclick="window.history.back()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
            Kembali
        </button>
        
        <section id="page-home">
            <div class="hero">
                <div class="hero-content">
                    <h1>Laporkan. Lindungi. <br><span style="color:var(--text-main)">Peduli Sesama.</span></h1>
                    <p style="color:var(--text-main); font-weight: 500;">Jangan diam saat melihat penindasan. Sekolah harus menjadi tempat yang aman bagi semua. Identitasmu aman bersama kami.</p>
                    <div style="display:flex; gap:15px; flex-wrap:wrap; margin-top: 25px;">
                        <button onclick="showPage('report')" class="btn btn-primary">Laporkan Bullying Sekarang</button>
                        <button onclick="showPage('education')" class="btn btn-outline">Pelajari Lebih Lanjut</button>
                    </div>
                </div>
                <div class="hero-img">
                    <div class="art">üõ°Ô∏è</div>
                </div>
            </div>

            <h2 style="margin-top: 40px; text-align: center;">Mengapa Memilih SIABS?</h2>
            <div class="grid grid-3">
                <div class="card">
                    <h3 style="color:var(--primary)">üîí Anonimitas Mutlak</h3>
                    <p class="text-sm">Anda bisa melapor tanpa mengungkapkan identitas. Keamanan pelapor adalah prioritas utama.</p>
                </div>
                <div class="card">
                    <h3 style="color:var(--danger)">üö´ Tindakan Cepat</h3>
                    <p class="text-sm">Setiap laporan diverifikasi dan ditindaklanjuti Tim BK & Kesiswaan dalam waktu 1x24 jam kerja.</p>
                </div>
                <div class="card">
                    <h3 style="color:var(--success)">ü§ù Dukungan Sebaya</h3>
                    <p class="text-sm">Jelajahi Diskusi Anonim untuk berbagi dan menerima dukungan dari teman-teman sekolah lainnya.</p>
                </div>
            </div>
        </section>

        <section id="page-report" class="hidden">
            <div class="card" style="max-width: 800px; margin: 40px auto;">
                <div style="text-align:center; margin-bottom:25px;">
                    <h2>Formulir Pengaduan</h2>
                    <p>Isi data dengan jujur. Pilihan anonimitas tersedia di bawah ini.</p>
                </div>

                <form id="bullyingForm">
                    <div class="form-group card" style="background:#f9f9ff; padding:20px; box-shadow: none;">
                        <label>Ingin melapor sebagai anonim?</label>
                        <div class="checkbox-group">
                            <label class="checkbox-card" id="btn-anon-no" onclick="setAnon(false)">
                                Tidak (Sertakan Identitas)
                            </label>
                            <label class="checkbox-card" id="btn-anon-yes" onclick="setAnon(true)">
                                Ya, Saya ingin Anonim
                            </label>
                        </div>
                        <input type="hidden" id="isAnonymous" value="false">
                    </div>

                    <div id="reporter-fields" class="grid-2">
                        <div class="form-group">
                            <label>Nama Pelapor</label>
                            <input type="text" id="reporterName" placeholder="Nama Lengkap">
                        </div>
                        <div class="form-group">
                            <label>Kelas Pelapor</label>
                            <input type="text" id="reporterClass" placeholder="Misal: X IPA 1">
                        </div>
                    </div>

                    <hr style="margin: 30px 0; border:0; border-top:1px solid #e2e8f0;">

                    <div class="grid-2">
                        <div class="form-group">
                            <label>Nama Korban <span style="color:red">*</span></label>
                            <input type="text" id="victimName" required placeholder="Siapa yang dibully?">
                        </div>
                        <div class="form-group">
                            <label>Nama Pelaku (Jika tahu)</label>
                            <input type="text" id="perpName" placeholder="Siapa yang melakukan?">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Jenis Bullying (Bisa pilih lebih dari satu)</label>
                        <div class="checkbox-group">
                            <label class="checkbox-card" onclick="toggleCheck(this, 'Fisik')">üëä Fisik</label>
                            <label class="checkbox-card" onclick="toggleCheck(this, 'Verbal')">üó£Ô∏è Verbal/Ejekan</label>
                            <label class="checkbox-card" onclick="toggleCheck(this, 'Sosial')">üö´ Pengucilan</label>
                            <label class="checkbox-card" onclick="toggleCheck(this, 'Siber')">üì± Cyberbullying</label>
                            <label class="checkbox-card" onclick="toggleCheck(this, 'Seksual')">‚ö†Ô∏è Pelecehan</label>
                        </div>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>Tanggal Kejadian</label>
                            <input type="date" id="date" required>
                        </div>
                        <div class="form-group">
                            <label>Lokasi Kejadian</label>
                            <input type="text" id="location" placeholder="Kantin, Kelas, WA Group, dll">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Ceritakan Kronologinya <span style="color:red">*</span></label>
                        <textarea id="description" rows="5" placeholder="Ceritakan apa yang terjadi, siapa saja yang melihat, apa yang dikatakan..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Bukti (Foto/Screenshot) - Opsional</label>
                        <input type="file" id="evidence" accept="image/*">
                        <p class="text-sm" style="margin-top:5px; color:var(--text-muted)">Maksimal 2MB. Hanya dilihat oleh Admin.</p>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn btn-primary" style="width:100%; margin-top: 10px;">Kirim Laporan</button>
                    </div>
                </form>
            </div>
        </section>

        <section id="page-forum" class="hidden">
            <div style="max-width: 700px; margin: 40px auto;">
                <h2 class="text-center">Diskusi Anonim (#SIABS_Curhat)</h2>
                <p class="text-center text-sm" style="margin-bottom: 25px;">Bagikan pengalaman atau dukungan secara anonim. **Dilarang menyebut nama personal atau kode identifikasi yang jelas.**</p>

                <div class="card" style="margin-bottom: 20px;">
                    <form id="forumPostForm">
                        <div class="form-group">
                            <textarea id="forumContent" rows="4" placeholder="Apa yang ada di pikiran Anda? Maksimal 280 karakter." maxlength="280" required></textarea>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span id="charCount" class="text-sm" style="color: var(--text-muted); margin-left: 5px;">280</span>
                            <button type="submit" class="btn btn-primary btn-sm">Kirim Postingan Anonim</button>
                        </div>
                    </form>
                </div>

                <div id="forumThreadsContainer">
                    </div>
            </div>
        </section>
        
        <section id="page-education" class="hidden">
            <h2 class="text-center" style="margin-top:40px">Edukasi Anti-Bullying</h2>
            <div class="grid grid-2">
                <div class="card">
                    <h3>Apa itu Bullying?</h3>
                    <p>Perilaku agresif yang dilakukan berulang-ulang oleh seseorang atau sekelompok siswa yang memiliki kekuasaan, terhadap siswa lain yang lebih lemah.</p>
                </div>
                <div class="card">
                    <h3>Jenis-Jenis Bullying</h3>
                    <ul style="padding-left:20px; color:var(--text-muted)">
                        <li><strong>Verbal:</strong> Mengejek, menghina, memfitnah.</li>
                        <li><strong>Fisik:</strong> Memukul, menendang, merusak barang.</li>
                        <li><strong>Relasional:</strong> Mengucilkan, menyebar gosip.</li>
                        <li><strong>Cyber:</strong> Teror lewat media sosial/chat.</li>
                    </ul>
                </div>
            </div>
            
            <div class="card" style="margin-top:20px; background:#f0f9ff; border-left: 5px solid var(--accent);">
                <h3 style="color:var(--accent)">Jadilah Upstander, Bukan Bystander!</h3>
                <p><strong>Bystander:</strong> Orang yang melihat bullying tapi diam saja.<br>
                <strong>Upstander:</strong> Orang yang bertindak untuk membantu korban atau melapor.</p>
                <p>Langkah kecilmu bisa menyelamatkan temanmu.</p>
            </div>

            <div class="card" style="max-width: 800px; margin: 40px auto; text-align:center;">
                <h2 style="color:var(--danger); margin-bottom: 0.5rem;">üéÆ Mini Game: Jalur Pilihan Kata</h2>
                <p>Uji kemampuanmu merespons situasi *bullying* dan menjadi *Upstander* yang efektif! Pilihanmu menentukan hasil akhirnya.</p>
                
                <div id="game-container" style="border: 2px solid #e2e8f0; border-radius: 12px; padding: 25px; margin-top: 25px; text-align: left; background: #fafafc;">
                    
                    <div id="game-start-screen">
                        <p class="text-center">Siap memulai simulasi singkat? Pilihanmu menentukan nasib temanmu.</p>
                        <button class="btn btn-primary" style="width:100%; margin-top:15px;" onclick="startGame()">Mulai Simulasi</button>
                    </div>

                    <div id="game-simulation-screen" class="hidden">
                        <div style="background: var(--card-bg); padding: 18px; border-radius: 8px; margin-bottom: 20px; border-left: 5px solid var(--primary-light);">
                            <p class="text-sm" style="color: var(--text-main); font-weight: 600;">Peran Anda: <span id="game-role" style="color: var(--primary);"></span></p>
                            <p id="game-dialogue" style="margin-bottom: 0; font-size: 1.15rem; color: var(--text-main); font-weight: 500; margin-top: 10px;"></p>
                        </div>
                        <p style="font-weight: 600;">Apa pilihan Anda?</p>
                        <div id="game-choices" style="display: grid; gap: 12px;">
                            </div>
                    </div>

                    <div id="game-end-screen" class="hidden" style="text-align: center;">
                        <h3 id="game-result-title" style="margin-bottom: 10px;"></h3>
                        <p id="game-result-dialogue"></p>
                        <button class="btn btn-outline" style="margin-top: 20px;" onclick="resetGame()">Main Lagi</button>
                    </div>
                </div>
            </div>
            </section>

        <section id="page-procedure" class="hidden">
            <div class="card" style="max-width:800px; margin:40px auto;">
                <h2>Prosedur Penanganan</h2>
                <ol style="padding-left:20px; line-height:2; color:var(--text-main); font-weight: 500;">
                    <li><strong>Pelaporan:</strong> Siswa mengirim laporan lewat website ini.</li>
                    <li><strong>Verifikasi:</strong> Tim BK menerima data dan memverifikasi (1x24 jam).</li>
                    <li><strong>Investigasi:</strong> Tim memanggil pihak terkait secara terpisah (Rahasia terjaga).</li>
                    <li><strong>Tindakan:</strong>
                        <ul style="color: var(--text-muted); list-style: circle; padding-left: 20px; margin-top: 5px;">
                            <li>Restitusi/Mediasi (untuk kasus ringan).</li>
                            <li>Konseling & Pendampingan.</li>
                            <li>Sanksi Sekolah (untuk kasus berat).</li>
                        </ul>
                    </li>
                    <li><strong>Pemulihan:</strong> Memastikan korban merasa aman kembali di sekolah.</li>
                </ol>
            </div>
        </section>

        <section id="page-contact" class="hidden">
            <div class="grid grid-2" style="margin-top:40px">
                <div class="card">
                    <h3>Kontak Sekolah</h3>
                    <p>Ruang BK (Bimbingan Konseling)<br>Lantai 2 Gedung A</p>
                    <p style="font-size: 1.1rem; font-weight: 600;"><strong>Bu Ani (Koordinator BK):</strong> 0812-xxxx-xxxx</p>
                    <p style="font-size: 1.1rem; font-weight: 600;"><strong>Pak Budi (Kesiswaan):</strong> 0813-xxxx-xxxx</p>
                    <button class="btn btn-primary btn-sm" style="margin-top:15px">Hubungi BK Sekarang</button>
                </div>
                <div class="card" style="border-left:5px solid var(--danger)">
                    <h3>Layanan Luar Sekolah (Darurat)</h3>
                    <p>Jika kasus darurat atau di luar jangkauan sekolah:</p>
                    <p><strong>KPAI (Komisi Perlindungan Anak):</strong> 021-3190xxxx</p>
                    <p><strong>Telepon Sahabat Anak (TeSA):</strong> 129</p>
                    <button class="btn btn-danger btn-sm" style="margin-top:15px">Tombol Panic Lokal</button>
                </div>
            </div>
        </section>

        <section id="page-admin" class="hidden">
            <div id="login-panel" class="card" style="max-width:400px; margin: 60px auto; text-align:center;">
                <h3>Login Admin</h3>
                <input type="password" id="adminPass" placeholder="Password" style="margin-bottom:15px;">
                <button onclick="loginAdmin()" class="btn btn-primary" style="width:100%">Masuk</button>
            </div>

            <div id="admin-panel" class="hidden">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; margin-top:20px;">
                    <h2>Dashboard Konselor</h2>
                    <button onclick="logoutAdmin()" class="btn btn-danger text-sm">Keluar</button>
                </div>

                <div class="stats-grid">
                    <div class="card stat-card" style="border-left: 4px solid var(--primary); padding: 20px;">
                        <div class="stat-value" id="count-total">0</div>
                        <div class="stat-label">Total Laporan</div>
                    </div>
                    <div class="card stat-card" style="border-left: 4px solid var(--danger); padding: 20px;">
                        <div class="stat-value" id="count-new">0</div>
                        <div class="stat-label">Baru</div>
                    </div>
                    <div class="card stat-card" style="border-left: 4px solid orange; padding: 20px;">
                        <div class="stat-value" id="count-process">0</div>
                        <div class="stat-label">Diproses</div>
                    </div>
                    <div class="card stat-card" style="border-left: 4px solid var(--success); padding: 20px;">
                        <div class="stat-value" id="count-done">0</div>
                        <div class="stat-label">Selesai</div>
                    </div>
                </div>

                <div class="card">
                    <h3>Daftar Laporan Masuk</h3>
                    <div style="overflow-x:auto;">
                        <table id="report-table">
                            <thead>
                                <tr>
                                    <th>Tgl</th>
                                    <th>Pelapor</th>
                                    <th>Korban</th>
                                    <th>Jenis</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <div class="floating-actions">
        <button class="fab fab-panic" onclick="panicAlert()" title="PANIC BUTTON: Lapor Darurat">
            SOS
        </button>
    </div>

    <script>
        // --- DATA MANAGEMENT (Local Storage) ---
        const DB_KEY = 'siabs_data_v2';
        const FORUM_KEY = 'siabs_forum_v1';
        let reports = JSON.parse(localStorage.getItem(DB_KEY) || '[]');
        let forumThreads = JSON.parse(localStorage.getItem(FORUM_KEY) || '[]');
        let selectedTypes = [];

        function saveDB() {
            localStorage.setItem(DB_KEY, JSON.stringify(reports));
            renderAdmin();
        }
        
        function saveForumDB() {
            localStorage.setItem(FORUM_KEY, JSON.stringify(forumThreads));
            renderForum();
        }

        // --- NAVIGATION & UI ---
        function toggleMobileMenu() {
            document.getElementById('nav-links').classList.toggle('active');
        }

        function showPage(pageId, pushHistory = true) {
            document.querySelectorAll('main > section').forEach(el => el.classList.add('hidden'));
            document.getElementById('page-' + pageId).classList.remove('hidden');
            
            // Close mobile menu if open
            document.getElementById('nav-links').classList.remove('active');
            
            if (pushHistory) {
                window.history.pushState({ pageId: pageId }, `SIABS - ${pageId.charAt(0).toUpperCase() + pageId.slice(1)}`, `#${pageId}`);
            }
            
            const backBtn = document.getElementById('back-btn');
            
            if (pageId === 'home') {
                backBtn.classList.add('hidden');
            } else {
                backBtn.classList.remove('hidden'); 
            }

            // Update Active Nav
            document.querySelectorAll('.nav-links a').forEach(el => el.classList.remove('active'));
            document.querySelector(`.nav-links a[onclick="showPage('${pageId}')"]`)?.classList.add('active'); 
            
            if (pageId === 'forum') {
                renderForum();
            }

            window.scrollTo(0,0);
        }

        window.onpopstate = function(event) {
            const state = event.state;
            if (state && state.pageId) {
                showPage(state.pageId, false);
            } else if (window.location.hash) {
                showPage(window.location.hash.substring(1), false);
            } else {
                showPage('home', false);
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            const initialPageId = window.location.hash.substring(1) || 'home';
            
            window.history.replaceState({ pageId: initialPageId }, 'SIABS - Beranda', `#${initialPageId}`);
            
            showPage(initialPageId, false); 
            
            setAnon(false);

            const forumContent = document.getElementById('forumContent');
            const charCountSpan = document.getElementById('charCount');
            if (forumContent && charCountSpan) {
                forumContent.addEventListener('input', () => {
                    const currentLength = forumContent.value.length;
                    const remaining = 280 - currentLength;
                    charCountSpan.innerText = remaining;
                    charCountSpan.style.color = remaining < 10 ? 'var(--danger)' : 'var(--text-muted)';
                });
            }
            
            if (initialPageId === 'forum') {
                renderForum();
            }
        });
        
        // Panic Button
        function panicAlert() {
            if(confirm("DARURAT! Kirim sinyal SOS ke admin? Lokasi Anda akan dicatat.")) {
                const report = {
                    id: 'SOS-' + Date.now(),
                    date: new Date().toISOString().split('T')[0],
                    reporterName: 'SYSTEM SOS',
                    victimName: 'PENGGUNA TOMBOL PANIC',
                    type: ['DARURAT'],
                    desc: 'Tombol SOS ditekan! Segera cek lokasi.',
                    status: 'Baru',
                    isAnon: true
                };
                reports.unshift(report);
                saveDB();
                alert("Sinyal SOS terkirim!");
            }
        }

        // --- FORM HANDLING ---
        function setAnon(isAnon) {
            const fields = document.getElementById('reporter-fields');
            const hiddenVal = document.getElementById('isAnonymous');
            const btnNo = document.getElementById('btn-anon-no');
            const btnYes = document.getElementById('btn-anon-yes');

            hiddenVal.value = isAnon;
            if(isAnon) {
                fields.style.display = 'none';
                btnYes.classList.add('checked');
                btnNo.classList.remove('checked');
            } else {
                fields.style.display = 'grid';
                btnYes.classList.remove('checked');
                btnNo.classList.add('checked');
            }
        }

        function toggleCheck(el, value) {
            el.classList.toggle('checked');
            if(selectedTypes.includes(value)) {
                selectedTypes = selectedTypes.filter(t => t !== value);
            } else {
                selectedTypes.push(value);
            }
        }

        document.getElementById('bullyingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const isAnon = document.getElementById('isAnonymous').value === 'true';
            
            const newReport = {
                id: 'R-' + Date.now().toString().slice(-6),
                date: document.getElementById('date').value,
                reporterName: isAnon ? 'Anonim' : document.getElementById('reporterName').value,
                reporterClass: isAnon ? '-' : document.getElementById('reporterClass').value,
                victimName: document.getElementById('victimName').value,
                perpName: document.getElementById('perpName').value || 'Tidak diketahui',
                type: selectedTypes.length > 0 ? selectedTypes : ['Lainnya'],
                location: document.getElementById('location').value,
                desc: document.getElementById('description').value,
                status: 'Baru',
                evidence: document.getElementById('evidence').value 
            };

            reports.unshift(newReport);
            saveDB();
            
            alert('Laporan berhasil dikirim. Terima kasih sudah berani melapor.');
            this.reset();
            selectedTypes = [];
            document.querySelectorAll('.checkbox-card').forEach(c => c.classList.remove('checked'));
            showPage('home');
        });

        // --- FORUM LOGIC ---
        document.getElementById('forumPostForm').addEventListener('submit', function(e) {
            e.preventDefault();
            postThread();
        });

        function postThread() {
            const content = document.getElementById('forumContent').value.trim();
            if (content.length === 0 || content.length > 280) {
                alert("Konten tidak valid. Pastikan tidak kosong dan tidak melebihi 280 karakter.");
                return;
            }

            const newThread = {
                id: 'T-' + Date.now().toString().slice(-6),
                content: content,
                timestamp: new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' }),
                likes: 0,
                comments: 0
            };

            forumThreads.unshift(newThread);
            saveForumDB();
            
            document.getElementById('forumContent').value = ''; 
            document.getElementById('charCount').innerText = '280';
        }

        function renderForum() {
            const container = document.getElementById('forumThreadsContainer');
            if (!container) return; 

            container.innerHTML = ''; 

            if (forumThreads.length === 0) {
                container.innerHTML = '<p class="text-center text-muted" style="margin-top: 30px;">Belum ada postingan diskusi anonim. Jadilah yang pertama!</p>';
                return;
            }

            forumThreads.forEach(thread => {
                const threadCard = document.createElement('div');
                threadCard.className = 'thread-card';
                threadCard.innerHTML = `
                    <div class="thread-meta">
                        <span class="anon-label">Pengguna Anonim #${thread.id.split('-')[1]}</span>
                        <span class="text-sm text-muted">${thread.timestamp}</span>
                    </div>
                    <p class="thread-content" style="color:var(--text-main);">${thread.content}</p>
                    <div class="thread-actions">
                        <button onclick="interactWithThread('${thread.id}', 'like')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3z"/></svg>
                            Dukung (${thread.likes})
                        </button>
                        <button onclick="interactWithThread('${thread.id}', 'comment')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
                            Komentar (${thread.comments})
                        </button>
                    </div>
                `;
                container.appendChild(threadCard);
            });
        }

        window.interactWithThread = function(id, type) {
            const thread = forumThreads.find(t => t.id === id);
            if (thread) {
                if (type === 'like') {
                    thread.likes++;
                    alert(`Anda mendukung postingan ini! Dukungan: ${thread.likes}`);
                } else if (type === 'comment') {
                    thread.comments++;
                    alert(`Simulasi Komentar: Anda telah menambahkan komentar (jumlah ${thread.comments}).`);
                }
                saveForumDB();
            }
        }
        
        // --- ADMIN LOGIC (unchanged) ---
        function loginAdmin() {
            const p = document.getElementById('adminPass').value;
            if(p === 'admin123') {
                document.getElementById('login-panel').classList.add('hidden');
                document.getElementById('admin-panel').classList.remove('hidden');
                renderAdmin();
            } else {
                alert('Password Salah!');
            }
        }

        function logoutAdmin() {
            document.getElementById('login-panel').classList.remove('hidden');
            document.getElementById('admin-panel').classList.add('hidden');
            document.getElementById('adminPass').value = '';
            showPage('home'); 
        }

        function renderAdmin() {
            document.getElementById('count-total').innerText = reports.length;
            document.getElementById('count-new').innerText = reports.filter(r => r.status === 'Baru').length;
            document.getElementById('count-process').innerText = reports.filter(r => r.status === 'Proses').length;
            document.getElementById('count-done').innerText = reports.filter(r => r.status === 'Selesai').length;

            const tbody = document.querySelector('#report-table tbody');
            tbody.innerHTML = '';
            
            reports.forEach(r => {
                let badgeClass = 'badge-new';
                if(r.status === 'Proses') badgeClass = 'badge-process';
                if(r.status === 'Selesai') badgeClass = 'badge-done';

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${r.date}</td>
                    <td>${r.reporterName}</td>
                    <td>${r.victimName}</td>
                    <td>${r.type.join(', ')}</td>
                    <td><span class="badge ${badgeClass}">${r.status}</span></td>
                    <td>
                        <button class="btn-ghost" onclick="viewReport('${r.id}')">üëÅÔ∏è</button>
                        <button class="btn-ghost" style="color:var(--success)" onclick="updateStatus('${r.id}', 'Proses')">‚öôÔ∏è</button>
                        <button class="btn-ghost" style="color:var(--primary)" onclick="updateStatus('${r.id}', 'Selesai')">‚úÖ</button>
                        <button class="btn-ghost" style="color:var(--danger)" onclick="deleteReport('${r.id}')">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        window.viewReport = function(id) {
            const r = reports.find(x => x.id === id);
            alert(`DETAIL LAPORAN:\n\nKorban: ${r.victimName}\nPelaku: ${r.perpName}\nKronologi: ${r.desc}\nLokasi: ${r.location}`);
        }

        window.updateStatus = function(id, status) {
            const r = reports.find(x => x.id === id);
            if(r) {
                r.status = status;
                saveDB();
            }
        }

        window.deleteReport = function(id) {
            if(confirm('Hapus laporan ini secara permanen?')) {
                reports = reports.filter(x => x.id !== id);
                saveDB();
            }
        }

        // --- MINI GAME LOGIC (unchanged) ---
        const gameScenarios = {
            'start': {
                dialogue: "Selamat datang di simulasi! Anda akan mengambil peran sebagai Saksi (Upstander) atau Korban. Pilihan Anda menentukan keberhasilan intervensi.",
                role: "Pemain",
                choices: [
                    { text: "Mulai Skenario 1: Konflik Loker (Verbal/Fisik)", next: 's1' },
                    { text: "Mulai Skenario 2: Pengucilan Grup Tugas (Sosial)", next: 's2' },
                    { text: "Mulai Skenario 3: Foto Memalukan di Medsos (Siber)", next: 's3' },
                    { text: "Mulai Skenario 4: Penindasan di Kelas (Fisik Ringan)", next: 's4' },
                    { text: "Mulai Skenario 5: Ejekan Mengenai Latar Belakang (Verbal)", next: 's5' }
                ]
            },
            
            // --- SCENARIO 1: Konflik Loker (Verbal/Fisik) ---
            's1': {
                dialogue: "Anda sedang berjalan di koridor dan melihat Budi (korban) sedang diintimidasi secara verbal oleh Tono (pelaku) di depan loker. Tono mengancam akan memukul Budi.",
                role: "Saksi/Upstander",
                choices: [
                    { text: "Pilihan A: Mendekat, berkata, 'Tono, hentikan itu! Jangan sampai aku lapor.' (Menegur Langsung)", next: 's1_a' },
                    { text: "Pilihan B: Cepat lari ke Ruang Guru terdekat untuk meminta bantuan. (Aksi Cepat)", next: 'end_good_1' }, 
                    { text: "Pilihan C: Diam-diam merekam kejadian sebagai bukti, tanpa intervensi. (Aksi Pasif)", next: 's1_b' }
                ]
            },
            's1_a': {
                dialogue: "Tono terkejut, namun ia tersinggung dan malah menantang Anda. Budi semakin ketakutan. Situasi memanas. Apa yang Anda lakukan sekarang?",
                role: "Saksi/Upstander",
                choices: [
                    { text: "Pilihan A1: Ajak Budi segera menjauh dan cari guru/konselor. (Tinggalkan Lokasi)", next: 'end_good_1' },
                    { text: "Pilihan A2: Berdebat dengan Tono dan membela Budi. (Risiko Konflik Fisik)", next: 'end_bad_1' }
                ]
            },
            's1_b': {
                dialogue: "Anda mendapat bukti (rekaman), namun Tono memukul Budi sebelum guru datang. Anda terlambat intervensi. Anda mendapat poin netral karena memiliki bukti, tapi gagal mencegah kekerasan.",
                role: "Saksi/Upstander",
                result: 'neutral'
            },
            
            // --- SCENARIO 2: Pengucilan Grup Tugas (Sosial) ---
            's2': {
                dialogue: "Anda (Rina) adalah anggota kelompok tugas. Tiga anggota lain berkomunikasi di grup chat lain, meninggalkan Anda, dan bahkan mengirim stiker ejekan di grup umum. Anda merasa sangat sedih dan dikucilkan.",
                role: "Korban",
                choices: [
                    { text: "Pilihan A: Kirim pesan di grup: 'Hei, kenapa kalian mengucilkan aku? Aku juga anggota!' (Tegur dan Minta Klarifikasi)", next: 's2_a' },
                    { text: "Pilihan B: Diam, tinggalkan grup chat, dan menangis sendirian. (Menarik Diri)", next: 'end_bad_2' },
                    { text: "Pilihan C: Langsung temui guru mata pelajaran atau Konselor dengan bukti screenshot grup. (Lapor Formal)", next: 'end_good_2' }
                ]
            },
            's2_a': {
                dialogue: "Mereka hanya membalas dengan 'Bukan urusanmu, Rina.' dan 'Kelompokmu bukan di sini.' Apa langkah Anda selanjutnya?",
                role: "Korban",
                choices: [
                    { text: "Pilihan A1: Ceritakan ke salah satu teman yang Anda percaya. (Cari Dukungan)", next: 'end_neutral_2' },
                    { text: "Pilihan A2: Tetap diam, biarkan mereka urus tugasnya sendiri. (Putus Asa)", next: 'end_bad_2' }
                ]
            },

            // --- SCENARIO 3: Foto Memalukan (Siber) ---
            's3': {
                dialogue: "Anda melihat teman (Ayu) mengunggah foto memalukan teman lain (Sita) di Instagram Story-nya, dengan caption yang merendahkan.",
                role: "Saksi/Upstander",
                choices: [
                    { text: "Pilihan A: Screenshot foto tersebut dan kirim ke Ayu via DM, minta ia hapus, dan ingatkan tentang bahaya Cyberbullying. (Tegur Privat)", next: 's3_a' },
                    { text: "Pilihan B: Langsung laporkan postingan tersebut ke pihak Instagram dan screenshot sebagai bukti untuk guru. (Lapor Formal dan Teknis)", next: 'end_good_3' }, 
                    { text: "Pilihan C: *React* stiker 'ketawa' di Story-nya karena Anda tidak ingin terlibat. (Mendukung Pelaku)", next: 'end_bad_3' }
                ]
            },
            's3_a': {
                dialogue: "Ayu membalas DM Anda: 'Biasa saja, hanya bercanda.' dan tidak menghapus Story-nya. Apa tindakan Anda sekarang?",
                role: "Saksi/Upstander",
                choices: [
                    { text: "Pilihan A1: Hubungi Sita (korban), berikan dukungan, dan tawarkan bantuan untuk lapor. (Dukungan Korban)", next: 'end_neutral_3' },
                    { text: "Pilihan A2: Ya sudah, Anda sudah coba. Tidak melakukan apa-apa lagi. (Berhenti Berusaha)", next: 'end_bad_3' }
                ]
            },

            // --- SCENARIO 4: Penindasan di Kelas (Fisik Ringan) ---
            's4': {
                dialogue: "Saat guru keluar sebentar, Riko menendang kursi Fajar hingga Fajar jatuh dan kesakitan, tapi ia mencoba menahan tangis. Semua orang di kelas melihatnya.",
                role: "Saksi/Upstander",
                choices: [
                    { text: "Pilihan A: Cepat bantu Fajar berdiri, tanya keadaannya, dan katakan pada Riko, 'Hati-hati, Riko!' (Intervensi Langsung dan Sopan)", next: 's4_a' },
                    { text: "Pilihan B: Anda berlari keluar memanggil guru yang berada di ruang guru. (Mencari Otoritas)", next: 'end_good_4' },
                    { text: "Pilihan C: Mencibir Riko dari jauh, tanpa membantu Fajar. (Intervensi Verbal Negatif)", next: 'end_neutral_4' }
                ]
            },
            's4_a': {
                dialogue: "Riko merespons, 'Kenapa kamu ikut campur?' dan mendorong Fajar lagi. Apa yang Anda lakukan?",
                role: "Saksi/Upstander",
                choices: [
                    { text: "Pilihan A1: Angkat tangan dan teriak, 'Tolong! Riko mendorong Fajar lagi!' (Mencari Perhatian)", next: 'end_good_4' },
                    { text: "Pilihan A2: Minggir dan biarkan Riko. Anda tidak mau terlibat lebih jauh. (Mundur)", next: 'end_bad_4' }
                ]
            },

            // --- SCENARIO 5: Ejekan Latar Belakang (Verbal) ---
            's5': {
                dialogue: "Anda (Adi) sedang makan di kantin. Tiba-tiba, sekelompok senior mengejek Anda dengan keras, 'Lihat, dia si anak orang miskin! Makanannya pasti sisa tadi malam!'",
                role: "Korban",
                choices: [
                    { text: "Pilihan A: Balas ejekan mereka dengan nada tinggi. 'Urus saja urusan kalian!' (Respons Agresif)", next: 'end_bad_5' },
                    { text: "Pilihan B: Tinggalkan kantin dengan tenang, dan segera temui Konselor BK. (Prioritas Keamanan & Laporan)", next: 'end_good_5' },
                    { text: "Pilihan C: Telepon orang tua dan minta mereka datang ke sekolah. (Melibatkan Orang Dewasa Luar)", next: 'end_neutral_5' }
                ]
            },

            // --- ENDINGS ---
            'end_good_1': { dialogue: "üéâ Berhasil! Anda mencari bantuan otoritas atau mengajak korban menjauh dari ancaman, memastikan keamanan dan tindak lanjut formal. Anda adalah Upstander sejati!", result: 'good' },
            'end_good_2': { dialogue: "üéâ Berhasil! Anda langsung melaporkan pengucilan sosial dan memiliki bukti. Ini adalah langkah yang kuat untuk menghentikan bullying siber/sosial!", result: 'good' },
            'end_good_3': { dialogue: "üéâ Berhasil! Anda mengambil tindakan formal dan mengumpulkan bukti, memastikan insiden siber ditangani dengan serius. Upstander yang cerdas!", result: 'good' },
            'end_good_4': { dialogue: "üéâ Berhasil! Anda memprioritaskan keamanan Fajar dan mencari otoritas ketika intervensi langsung gagal. Ini adalah Upstander yang bertanggung jawab!", result: 'good' },
            'end_good_5': { dialogue: "üéâ Berhasil! Sebagai korban, Anda memilih keselamatan dan jalur formal (laporan BK) daripada konfrontasi. Ini adalah respons korban yang paling tepat!", result: 'good' },

            'end_neutral_1': { dialogue: "‚ö†Ô∏è Perlu Peningkatan! Anda memiliki bukti (rekaman) tapi gagal mencegah kekerasan fisik. Bukti penting, tapi mencegah lebih baik dari mengobati.", result: 'neutral' },
            'end_neutral_2': { dialogue: "‚ö†Ô∏è Perlu Peningkatan! Anda mendapat dukungan teman, tetapi masalah inti (tugas dan pengucilan) belum dilaporkan ke guru. Masalah mungkin berlanjut.", result: 'neutral' },
            'end_neutral_3': { dialogue: "‚ö†Ô∏è Perlu Peningkatan! Anda memberi dukungan kepada korban, tetapi tidak ada tindakan formal yang diambil untuk menghapus konten. Konten memalukan masih beredar.", result: 'neutral' },
            'end_neutral_4': { dialogue: "‚ö†Ô∏è Perlu Peningkatan! Anda menegur Riko secara verbal negatif, yang bisa memperburuk situasi. Anda juga tidak membantu korban secara fisik atau formal.", result: 'neutral' },
            'end_neutral_5': { dialogue: "‚ö†Ô∏è Perlu Peningkatan! Anda melibatkan orang tua yang mungkin membuat masalah melebar tanpa melalui prosedur sekolah. Lapor ke BK dulu adalah prioritas.", result: 'neutral' },
            
            'end_bad_1': { dialogue: "‚ùå Gagal. Anda memilih konfrontasi pribadi, meningkatkan risiko kekerasan fisik, dan mengabaikan keselamatan Budi. Jangan pernah mengambil risiko konflik fisik!", result: 'bad' },
            'end_bad_2': { dialogue: "‚ùå Gagal. Anda memilih untuk menarik diri dan tidak melapor. Pengucilan sosial akan berlanjut dan memengaruhi kesehatan mental Anda. Cari bantuan!", result: 'bad' },
            'end_bad_3': { dialogue: "‚ùå Gagal. Anda memilih untuk mendukung atau mengabaikan *cyberbullying*. Ini membuat Anda menjadi *bystander* yang memperkuat perilaku pelaku. Anda gagal melindungi teman Anda.", result: 'bad' },
            'end_bad_4': { dialogue: "‚ùå Gagal. Anda memilih mundur ketika situasi memanas. Fajar tetap dalam bahaya dan Riko lolos tanpa konsekuensi. Keberanian Anda hilang di tengah jalan.", result: 'bad' },
            'end_bad_5': { dialogue: "‚ùå Gagal. Respons agresif hanya akan memperburuk situasi dan meningkatkan konflik. Sebagai korban, utamakan keselamatan dan lapor ke pihak berwenang.", result: 'bad' }
        };

        let currentScenarioId = 'start';

        function startGame() {
            document.getElementById('game-start-screen').classList.add('hidden');
            document.getElementById('game-simulation-screen').classList.remove('hidden');
            currentScenarioId = 'start';
            renderScenario();
        }

        function renderScenario() {
            const scenario = gameScenarios[currentScenarioId];
            const choicesDiv = document.getElementById('game-choices');
            
            document.getElementById('game-role').innerText = scenario.role;
            document.getElementById('game-dialogue').innerText = scenario.dialogue;
            choicesDiv.innerHTML = '';
            
            if (scenario.result) {
                // Ending scenario
                document.getElementById('game-simulation-screen').classList.add('hidden');
                document.getElementById('game-end-screen').classList.remove('hidden');
                displayResult(scenario.result, scenario.dialogue);
                return;
            }

            // Render choices
            scenario.choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = 'btn btn-outline';
                button.style.width = '100%';
                button.innerText = choice.text;
                button.onclick = () => choose(choice.next);
                choicesDiv.appendChild(button);
            });
        }

        function choose(nextScenarioId) {
            currentScenarioId = nextScenarioId;
            renderScenario();
        }

        function displayResult(resultType, dialogue) {
            const titleEl = document.getElementById('game-result-title');
            const dialogueEl = document.getElementById('game-result-dialogue');
            const gameContainer = document.getElementById('game-container'); 
            
            const SUCCESS_COLOR = '#10b981';
            const NEUTRAL_COLOR = '#f97316'; 
            const DANGER_COLOR = '#ef4444';
            const SUCCESS_BG = '#d1fae5'; 
            const NEUTRAL_BG = '#fef3c7'; 
            const DANGER_BG = '#fee2e2'; 

            gameContainer.style.border = '2px solid #e2e8f0'; 
            gameContainer.style.backgroundColor = '#fafafc';

            if (resultType === 'good') {
                titleEl.innerText = "üéâ Berhasil! Anda adalah Upstander!";
                titleEl.style.color = SUCCESS_COLOR;
                gameContainer.style.border = `2px solid ${SUCCESS_COLOR}`;
                gameContainer.style.backgroundColor = SUCCESS_BG; 
            } else if (resultType === 'neutral') {
                titleEl.innerText = "‚ö†Ô∏è Perlu Peningkatan!";
                titleEl.style.color = NEUTRAL_COLOR;
                gameContainer.style.border = `2px solid ${NEUTRAL_COLOR}`;
                gameContainer.style.backgroundColor = NEUTRAL_BG; 
            } else {
                titleEl.innerText = "üö® Gagal! Anda memilih menjadi Bystander.";
                titleEl.style.color = DANGER_COLOR;
                gameContainer.style.border = `2px solid ${DANGER_COLOR}`;
                gameContainer.style.backgroundColor = DANGER_BG; 
            }
            
            dialogueEl.innerText = dialogue;
        }

        function resetGame() {
            const gameContainer = document.getElementById('game-container');
            gameContainer.style.border = '2px solid #e2e8f0'; 
            gameContainer.style.backgroundColor = '#fafafc';
            document.getElementById('game-end-screen').classList.add('hidden');
            document.getElementById('game-start-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>